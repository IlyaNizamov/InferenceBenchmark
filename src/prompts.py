from dataclasses import dataclass
from pydantic import BaseModel, Field


# Тестовое деловое письмо для бенчмарка
BUSINESS_LETTER = """\
Уважаемые коллеги,

По итогам совещания от 15 января 2025 года направляю вам обновлённый план работ \
по проекту «Модернизация складской логистики».

1. Интеграция с WMS-системой (ответственный — Петров А.В., срок — 28 февраля):
   Необходимо завершить разработку API-коннектора и провести нагрузочное тестирование
   на тестовом стенде. Прошу учесть замечания отдела безопасности по шифрованию данных
   при передаче между системами.

2. Обновление парка сканеров штрих-кодов (ответственный — Сидорова Е.М., срок — 15 марта):
   Закупка 120 единиц оборудования согласована с финансовым отделом. Требуется
   организовать обучение персонала смен А и Б до ввода оборудования в эксплуатацию.

3. Миграция исторических данных (ответственный — Козлов Д.И., срок — 30 марта):
   Объём данных для миграции составляет около 2.4 ТБ. Прошу согласовать с IT-отделом
   окно для проведения миграции в нерабочее время, чтобы минимизировать простой.

Бюджет проекта на первый квартал утверждён в размере 4 800 000 руб. Перерасход
по статье «Оборудование» компенсирован экономией на статье «Консалтинг».

Следующее совещание состоится 1 февраля в 14:00 в переговорной комнате 3.
Прошу подготовить промежуточные отчёты по своим направлениям.

С уважением,
Иванов Михаил Сергеевич
Руководитель проекта
"""


# --- SO-схемы для каждого сценария ---

class TranslationSchema(BaseModel):
    """Схема для перевода письма"""
    translation: str = Field(description="Полный перевод письма на английский язык")
    key_terms: str = Field(description="Ключевые термины и их перевод")


class SummarySchema(BaseModel):
    """Схема для саммари письма"""
    summary: str = Field(description="Краткое содержание письма в 2-3 предложениях")
    action_items: str = Field(description="Список пунктов к исполнению")


class ResponseSchema(BaseModel):
    """Схема для составления ответного письма"""
    response: str = Field(description="Текст ответного делового письма")
    questions: str = Field(description="Уточняющие вопросы к отправителю")


# --- Тестовые сценарии ---

@dataclass
class TestCase:
    """Тестовый сценарий: промпт + SO-схема"""
    name: str
    prompt: str
    schema: type


TEST_CASES = [
    TestCase(
        name="Перевод",
        prompt=(
            "Переведи следующее деловое письмо на английский язык. "
            "Сохрани деловой стиль и форматирование:\n\n" + BUSINESS_LETTER
        ),
        schema=TranslationSchema,
    ),
    TestCase(
        name="Саммари",
        prompt=(
            "Составь краткое саммари следующего делового письма. "
            "Выдели основные тезисы, сроки и ответственных:\n\n" + BUSINESS_LETTER
        ),
        schema=SummarySchema,
    ),
    TestCase(
        name="Ответ",
        prompt=(
            "Составь ответное деловое письмо на следующее сообщение. "
            "Подтверди получение, задай уточняющие вопросы по срокам "
            "и ресурсам:\n\n" + BUSINESS_LETTER
        ),
        schema=ResponseSchema,
    ),
]
